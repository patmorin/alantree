\documentclass{patmorin}
\usepackage{pat}

\DeclareMathOperator{\exponential}{exponential}

\begin{document}
\section{Inequalities for Sums of Exponentials}

We will make use of two inequalities on sums of exponential random
variables, both of which can be obtained using Chernoff's bounding method.
If $Z_1,\ldots,Z_k$ are independent exponential random variables, each
with mean $\lambda=1$, then for all $d>1$,
\begin{equation}
    \Pr\left\{\sum_{i=1}^k Z_i \le k/d\right\} \le \exp(-k(\ln d -1 + 1/d)) \le \left(\frac{e}{d}\right)^k  \eqlabel{head-bound}
\end{equation}
and for all $t>1$, 
\begin{equation}
    \Pr\left\{\sum_{i=1}^n Z_i \ge tk\right\} \le \exp (k- k t/2) \enspace . \eqlabel{tail-bound}
\end{equation}


\section{The Exponential Process (First Passage Percolation)}

Consider the following process for growing a spanning tree, $T$, of an
$n$-vertex connected undirected graph $G$ starting from a distinguished
vertex $s\in V(G)$.  On each edge of $G$ we attach an exponential timer
with rate 1. When the timer on an edge $vw$ rings the timer is immediately
reset and, if exactly one of $v$ or $w$ is in $T$, then the edge $vw$
is added to $T$.  We call this \emph{Process~E} and we say that Process~E
is \emph{complete} once $T$ spans $G$.  Note that Process~E is equivalent to selecting an exponential(1) edge weight for each edge of $G$ and then computing the shortest path tree rooted at $s$.  We call this latter process Process~FP, for first-passage percolation.

\begin{lem}\lemlabel{percolation}
  If $G$ has diameter $D$ then, with probability at least $1-1/n$, $T$
  is a spanning tree after time at most $c(D+\log n)$.
\end{lem}


\begin{proof}
  Let $v$ be a vertex of $G$ such that there exists a path
  $v_0,\ldots,v_k$ of length $k$ in $G$ from $s=v_0$ to $v=v_k$.
  Let $e_i=v_{i-1}v_i$ be the $i$th edge on this path.

  For each $i\in\{1,\ldots,k\}$, the vertex $v_i$ joins the tree at some
  time $t_i$.  Once this happens, the vertex $v_{i+1}$ will join the tree
  at or before the next ring of the timer on edge $e_{i+1}$.  (Note that
  $v_{i+1}$ may join the tree before this ring and even before $t_i$.)
  By the memoryless property of exponentials, this next ring occurs at
  time $t_i+Z_i$ where $Z_i$ is a an exponential random variable with
  rate 1.  Therefore, the random variable $t_k$ is dominated by the sum
  of $k$ independent exponentials $Z_1,\ldots,Z_k$.
  In particular, using \eqref{tail-bound},
  \[
      \Pr\{t_k\ge c(k+\log n)\} \le \Pr\{Z_1+\cdots Z_k\ge c(k+\log n)\} \le 1/n^2 \enspace .
  \]
  For each $v\in V(G)$, let $t(v)$ denote the time at which $v$ joins
  the tree $T$ and define $t=\max\{t(v):v\in V(G)\}$
  as the time at which the last vertex of $G$ joins 
  $T$.  Then,
  \[
      \Pr\{t> c(D+\log n)\} \le \sum_{v\in V(G)}\Pr\{t(v) \ge c(D+\log n)     
       \le 1/n \enspace . \qedhere
  \]
\end{proof}

\section{The Random Edge Choice Process}

Now note that the tree, $T$, that results from the preceding process
is distributed in the same way as the spanning tree that one gets by
starting with the tree $T=(\{s\},\emptyset)$ and repeatedly choosing
a uniform random edge $vw$ and adding $vw$ to $T$ if and only if $vw$
has exactly one endpoint in $V(T)$.  We the call second version Process~B.
That Process~E and Process~B produce identically distributed spanning
trees follows from the memorylessness of exponential random variables.
In particular, at any point in time, each of the $|E(G)|$ timers in
Process~E is equally likely to be the next timer to ring.

\subsection{The Upper Bound}

\begin{lem}\lemlabel{alantree-upper-bound}
  If $G$ has diameter $D$ and maximum degree $\Delta$ then after running
  Process~B to completion, with probability at least $1-O(1/n)$, the spanning
  tree $T$ has diameter at most $2c\Delta(D+\log n)$.
\end{lem}

\begin{proof}
  Let $P=v_0,v_1,\ldots,v_L$ be some simple path in $G$ starting at
  $s=v_0$ and let $e_i=v_{i-1}v_i$ be the $i$th edge on this path.
  In the model of Process~E, this path can not appear before the timer
  on $e_1$ rings, and then the timer on $e_2$ rings, and so on, until the
  timer on $e_L$ rings.  Let $t_L$ be the time at which this first occurs.
  Then $t_L$ is lower-bounded by the sum of $L$ independent exponential(1)
  random variables.  Using \eqref{head-bound}, we obtain
  \[
      \Pr\{t_L\} \le L/d \le \left(\frac{e}{d}\right)^L \enspace .
  \]
  If $P$ appears in $T$, then either $t_L < c(D+\log n)$ or $T$ is not
  yet a spanning tree of $G$ at time $c(D+\log n)$.  
  Therefore by the preceding discussion and \lemref{percolation}, 
  \[
      \Pr\{\text{$P$ appears in $T$}\} \le 1/n 
        + \left(\frac{ec(D+\log n)}{L}\right)^L \enspace .
  \]
  Let $P_L$ be the set of all simple paths in $G$ that start at $s$ and have length $L$.  The probability that $T$ contains any path from $P_L$ is at most
  \[
      1/n + |P_L|\left(\frac{\Delta ec(D+\log n)}{L}\right)^L 
      < 1/n + \left(\frac{\Delta ec(D+\log n)}{L}\right)^L \enspace ,
  \]
  since $|P_L|\le \Delta^L$.
  Finally, the probability that $T$ contains any path of length at least
  $L'=2\Delta ec(D+\log n)$ is at most
  \[
     \frac{1}{n}+\sum_{L=L'}^{n-1} \left(\frac{\Delta ec(D+\log n)}{L}\right)^L <  \frac{1}{n}+\sum_{L=L'}^{n-1} (1/2)^L < 2/n \enspace . \qedhere
  \]
\end{proof}


\subsection{The Lower Bound}

We will construct a graph, $G$, of diameter $D$ and maximum degree
$\Delta$ for which the upper bound in \thmref{X} is tight.  This graph is
obtained by gluing together two graphs $H$ and $I$. We begin by studing
them independently.

Fix some integers $L,\delta\in\N$ to be described later.  Refer to
\figref{h}.  The graph $H$ has a special vertex $s$ and $L$ groups of
vertices $V_1,\ldots,V_L$, each containing $\delta$ vertices.  Thus,
the vertex set of $H$ is has vertex set
\[
   V(H) = \{s\}\cup\bigcup_{i=1}^L V_i
\]
and edge set
\[
   E(H) = \{sv : v\in V_1\}
       \cup \{vw : v\in V_{i},\, w\in V_{i+1}\} \enspace .
\]
\begin{figure}
   \caption{The graph $H$.}
\end{figure}

\begin{lem}
   Assign an independent $\exponential(1)$ weight to each edge of $H$;
   for each $v,w\in V(H)$, define $d(v,w)$ as the weight of the shortest path from $v$
   to $w$ in the resulting weighted graph.  Then, for any $1\le i<
   j\le L$, any $v\in V_i$ and any $w\in V_j$,
   \[
       \Pr\{d(v,w) > (1+c)((j-i-1)/\delta + 1) \} \le
         \exp(-c(j-i-1)/2) + \exp(-(1+c)) \enspace .
   \]
\end{lem}

\begin{proof}
   Consider the following greedy algorithm for finding a path from $v\in V_i$
   to $w\in V_j$: When the path has reached some vertex $x\in V_{k}$, for
   $k<j-1$, the algorithm extends the path by taking the minimum weight
   edge between $x$ and some vertex in $V_{k+1}$.  When the algorithm
   reaches some $x\in V_{j-1}$, it takes the edge $xw$.

   Let $m=j-i$.
   Each of the first $m-1$ edges in the resulting path has a
   weight that is the minimum of $delta$ $\exponential(1)$ random
   variables.  Thus, the weight of these edges is the sum of $m-1$
   $\exponential(1/\delta)$ random variables $X_1,\ldots,X_{m-1}$.  
   By \eqref{tail-bound}, 
   \[
     \Pr\{\sum_{\ell=1}^{m-1} X_\ell \ge (1+c)(m-1) \} \le 
        \exp(-c(m-1)/2) \enspace .
   \]
   The last edge in this path has a weight $X_m$ that is an $\exponential(1)$
   random variable.  Therefore
   \[
      \Pr\{X_m > (1+c)\} \le \exp(-(1+c)) \enspace .
   \]
\end{proof}

Next, we consider a graph $I$ that is a binary tree with $L$ leaves,
where $L$ is a power of 2.  We can think of $I$ as a complete binary tree
with $L$ leaves whose edges have been subdivided.  More specifically,
at a node $v$ of height $h$ in this tree, we subdivide the edges leading
to $v$'s children
\[
   s(h) = a\cdot\max\{2^h/\delta,\log L\} 
\]
times so that each edge becomes a path of length $s(h)$.  The resulting
tree has $L$ leaves, $L-1$ degree 3 nodes, and the remaining nodes are
degree 2 nodes.  The height of this tree is
\[
   a\cdot\sum_{h=0}^{log L} \max\{\log L, 2^h/\delta\}
     = O( (\log\delta+\log\log L)\log L + L/\delta ) \enspace .
\]
\begin{lem}
   Assign $\exponential(1)$ independent edge weights to each of the edges
   of $I$, and let $v$ and $w$ be two leaves of $I$ such that the path from $u$ to $w$ visits $2h+1$ degree 3 nodes.  Then, 
   \[  
        \Pr\{d(v,w) \le 2s(h)/c  \} \le \left(\frac{e}{c}\right)^s(h) \enspace .
   \]
\end{lem}

\begin{proof}
   The path from $v$ to $w$ goes through a node that (before subdividing edges of $I$) had height $h$. Therefore, $d(u,w)$ is lower bounded by the sum of $2s(h)$ $\exponential(1)$ random variables.  The lemma now follows from \eqref{head-bound}.
\end{proof}

\end{document}

%Let $H=(V,E)$
%
%\begin{lem}
%  For every $D,\Delta\in\N$, there exists a graph $G$ with diameter
%  $D$ and maximum degree $\Delta$ such that after running Process~B
%  to completion, the expected height of $T$ is $\Omega(\Delta D)$.
%\end{lem}
%
%\begin{proof}
%  The graph $G$ is constructed as follows.  Start with a vertex $s$ and
%  $L$ groups $V_1,\ldots,V_L$ each containing $\delta$ vertices. There
%  is an edge joining $s$ to every vertex in $V_1$ and, for each
%  $i\in\{1,\ldots,L-1\}$, every vertex in $V_i$ is adjacent to every
%  vertex in $V_{i+1}$.  Call this graph $G^-$.
%
%  Next, we augment $G^-$ by selecting one evertex $v_i$ from each group
%  $V_i$ and building a complete binary tree, $T_G$ whose leaves, in order,
%  are $v_1,\ldots,v_L$.  Finally, we subdivide the edges of $T_G$ as follows:
%  If $v$ is a node of height $h\ge 1$ in $T_G$, then we subdivide the two
%  edges leading to $v$'s children into paths of length
%  \[
%      s(h) = a\cdot\max\{\log L, 2^h/\delta\} \enspace .
%  \]
%  Call the resulting tree $T_G'$.  The graph $G$ is the union of $G^-$ and $T_G'$.
%
%  Now, between any two vertices in $G$ there is path all but two of
%  whose edges are in $T_G'$ and of length at most
%  \[
%      D = 2+\sum_{h=1}^{\log L} s(h) = O(L/\Delta) \enspace .
%  \]
%  TODO: Do this calculation more carefully.
%
%  Now, imagine runing Process~FP on $G$.  First consider the subgraph
%  $G^-$.  Starting at $s$ and taking the lowest weight edge leads us to
%  some vertex in $V_1$.  From there we can take the lowest-weight edge to
%  reach a vertex in $V_2$, and so on, until reaching $V_L$.  The weight
%  of the resulting path is the sum of $L$ $\exponential(1/\delta)$
%  random variables.  For $t>1$, the probability that the weight of
%  this path exceeds $(b+1)L/\delta$ is therefore at most $\exp(-bL)$.
%  Therefore, with probability at least $1-\exp(-tL)$, the shortest path
%  in $P$ in $G^-$ from $s$ to any vertex $t$ in $V_L$ has weight at
%  most $(b+1)L/\Delta$.
%
%  The path $P$ will be will appear in the tree $T$ generated by Process~FP
%  unless there are are $i,j \in\binom{[L]}{2}$ such that the tree $T_G'$
%  contains a path from $v_i$ to $v_j$ of weight less than
%
%
%  
%
%
%  groups   
%  The graph $G$ is constructed as follows: Start with a complete
%  $\delta$-ary tree, $T_G$ of height $L=aD\Delta$ for some constant $a$
%  and some $\delta < \Delta$, each specified later.  Next, for each
%  root-to-leaf path $P$ in $T_G$, create a complete binary tree $T_P$
%  whose leaves are the vertices of $P$ in the same order they appear
%  in $P$.  Finally, subdivide each edge $e$ of $T_P$  $L/(\Delta \log_2
%  L)$ times so that $e$ becomes a path of length $L/(\Delta\log_2 L)$.
%
%  We claim that the resulting graph, $G$, has diameter $D\in O(L/\Delta)$.
%  (This isn't hard to show; For any two vertices in $T_G$, route to
%  their lowest common ancestor in $T_G$ using the two trees attached
%  to root-to-leaf paths.)  
%
%  Note that, as described above, the graph $G$ would have maximum degree
%  $\delta+\delta_L$, since the root of $T_G$ takes part in $\delta^L$
%  root-to-leaf paths.  To prevent this, we identify pairs of vertices in
%  these trees as follows:  Each vertex of $T_P$ corresponds to a segment
%  of root-to-leaf path in $T_G$.  If two vertices $v$ and $w$ from two
%  different trees $T_P$ and $T_Q$ correspond to the same segment, then
%  we identify $v$ and $w$.  We claim that the resulting graph has maximum
%  degree $\delta^2$. (This is either easy to prove, or not true.)
%
%  Let $s$ be the root of $T_G$.  Now, assign exponential(1) edge weights
%  to the edges of $G$.  First focus on a special subtree of $T_G$
%  obtained by starting at $s$ keeping only each child $w$ of $s$ in $T_G$
%  such that the edge weight on $sw$ is at most $c/\delta$ for some
%  constant $c$ discussed later.  We then do this recursively for each
%  such child $w$ of $s$ that survives.
% 
%  The tree $T'_G$ that results from this is a truncated Galton-Watson
%  tree in which the expected number of children at any node is (slightly
%  greater than) $c$.  Therefore, with probability at least $p$ (insert
%  a constant here---$p=1/2$?), $T'_G$ has at least $c^{L}$ leaves.
%
%  Now, consider one of the root-to-leaf paths, $P$, in $T'_G$.  Attached
%  to this path is a (subdivided) tree $T_P$.  Each vertex $v$ of $T_P$ is
%  the root of a subtree of height $h$ whose leaves are a subpath of $P$
%  of length $2^h$.  (Here the height $h$ is the height of $v$ in $T_P$
%  before subdividing edges.)  Now $v$ is incident to two edges $e_1$
%  and and $e_2$ leading to its two children in $T_P$.  After subdividing,
%  $e_1$ and $e_2$ become paths of length $L/(\Delta\log_2 L)$.
%  We say that $v$ is \emph{unlucky} if the sum of edge weights on each
%  of these paths exceeds $2^h/\delta$. 
%
%  The probability that one of these sums exceeds $2^h/\delta$ is the probability
%  that the sum of $k=L/(\delta\log_2(L)$ independent exponential(1) random variables exceeds $2^{h}/\Delta$:
%  \begin{align*}
%      \Pr\{\sum_{i=1}^{k} X_i \ge 2^{h}/\Delta\}
%          & \approx \exp(-k (k/-k^2\delta/2^{h})
%          & = \exp(-L^2/(\delta 2^{h}\log^2 L))
%  \end{align}
%
%
$c and, after subdivding, 
%+
%
%branching process defineds on $T_G$ as follows.  Start at $s$ and make
%  it adadd each
%  every child of $
%the root 
%
%two vertices $v$ and $w$ of two such trees $T_P$ and $T_Q$ if 
%
%
% 
%  To see this, note the each tree $T_P$ has height $\log_2(L)$, but each
%  edge of $T_P$ was subdivided $L/(\Delta\log_2 L)$ times.  Therefore,
%  the graph induced by the vertices of $T_P$ has diameter $O(L/\Delta)$.
%
%  Now, for 
%
%, so it has height
%  $L/(\Delta \log_2 D)$
%
%  Notice that the resulting graph has diameter $L/\Delta$
%
%
%  The graph $G$ consists of a $\delta$-ary tree for some $\delta = D-2$.
%
%
%
%  The graph $G$ is constructed by starting with a complete $b$-ary tree
%  $U$ of height $h$.  Next we add a vertex $w$ and a separate path of
%  length $k$ from $w$ to each vertex of $T$.  Call the resulting graph
%  $G$ an observe that the average degree of $G$ is $\Delta =O(b)$ and
%  that the diameter of $G$ is at most $D=2k$.
%
%  Consider the \emph{greedy path} in $U$ that starts at $s$ and
%  proceeds to the first child, $u$, of $s$ whose timer rings, and then
%  to the first child of $u$ whose timer rings, and so on until reaching
%  a leaf of $U$. Let $t_1$ denote the time at which the greedy path
%  reaches a leaf of $U$ and note that the greedy path will appear in
%  the tree $T$ generated by Process~E at time $t_1$ unless $w$ joins
%  $T$ before time $t_1$ (in which case the greedy path may
%  or may not appear in $T$).
%
%  The time $t_1$ is the sum of independent random variables
%  $Z_1,\ldots,Z_h$, where each $Z_i$ is the minimum of $d$ exponential(1)
%  random variables, so each $Z_i$ is an exponential with mean $1/b$.
%  The mean of $t_1$ is therefore $h/b$ and, for any $a>1$, with
%  probability at least $1-\exp((1-a)h)$,  $t_1\le ah/b$.\footnote{Check
%  this last tail bound.}
%
%  We now study the time at which $w$ joins $T$.  Notice that this happens
%  through some path that starts at $s$, walks in $U$ until some vertex $u$,
%  and then walks $k$ more steps outside of $U$ from $u$ to $w$.  When this
%  happens we say that \emph{$w$ joins $T$ through $u$}.
%  Fix a vertex $u$ at depth $r$ in $U$.  The probability that $w$ joins
%  $T$ through $u$ by time $ah/b$ is at most the probability that the $r+k$
%  relevant exponential(1) timers $Z_1,\ldots,Z_{r+k}$ sum to at most $ah/b$:
%  \[
%  \Pr\{\text{$w$ joins $T$ through $u$ by time $ah/b$}\} \le 
%  \Pr\left\{\sum_{i=1}^{r+k} Z_k \le ah/b\right\} = \left(\frac{eah}{b(r+k)}\right)^{r+k} \enspace .
%  \]
%  The tree, $U$ has $b^r$ vertices of depth $r$, so 
%  \begin{align*}
%   \Pr\{\text{$w$ joins $T$ by time $ah/b$}\} 
%      & \le \sum_{r=0}^h b^r \left(\frac{eah}{b(r+k)}\right)^{r+k} \\
%      & == \sum_{r=0}^h b^{-k} \left(\frac{eah}{r+k}\right)^{r+k} 
%    \enspace \ldots
%  \end{align*}
%  CRAP!
%\end{proof}
%
%
%Notice that, except for $w$, every vertex in the graph $G$ created in
%the preceding proof has degree at most $b+1$.  
\end{document}
