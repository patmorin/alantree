\documentclass[lotsofwhite]{patmorin}
\usepackage{pat}
\usepackage{graphicx}

\DeclareMathOperator{\exponential}{exponential}
\DeclareMathOperator{\binomial}{binomial}
\DeclareMathOperator{\gammarv}{Gamma}

\title{\MakeUppercase{Notes on Growing a Tree in a Graph}}
\author{\ }

\begin{document}
\maketitle

\begin{abstract}
We study the height of a spanning tree $T$ of a graph $G$ obtained by
starting with a single vertex of $G$ and repeatedly selecting, uniformly
at random, an edge of $G$ with exactly one endpoint in $T$ and adding
this edge to $T$.
\end{abstract}

\tableofcontents
\newpage

\section{Introduction}

We consider the following process for growing a spanning tree,
$T$, of a graph $G$ starting at some vertex $s\in V(G)$.  Intially,
$T=(s,\emptyset)$ is the single vertex tree containing only $s$. We then
repeatedly select, uniformly at random, an edge from $E(G)$ that has one
endpoint in $V(T)$ and one endpoint not in $V(T)$ and we add this edge
to $T$.  For an $n$-vertex connected graph $G$, the tree $T$ spans $G$
after $n-1$ iterations.  We call this Process~A.  We are interested in the
height of the (random) spanning tree generated by Process~A.

It turns out that there are several equivalent views of Process~A.
A slower version, called Process~B is obtained by repeatedly selecting
a uniformly random edge of $G$ and adding it to $T$ if and only if
exactly one endpoint of the edge is in $T$.  The number of iterations
of Process~B required before $T$ spans $G$ is now variable, but the
distribution of the resulting spanning tree is the same as Process~A.
(We can think of Process~B as implementing the edge selection of Process~A
using rejection sampling.)

Consider the following, which we call Process~E (for exponential).
On each edge of $G$ we attach an $\exponential(1)$ timer.  When the
timer on an edge $vw$ rings the timer is immediately reset and, if
exactly one of $v$ or $w$ is in $T$, then the edge $vw$ is added to $T$.
We say that Process~E is \emph{complete} once $T$ spans $G$.  Note that,
by the memorylessness of exponential random variables, at any point in
time, each edge is equally likely to be the next edge whose timer rings.
Thus, Process~E produces spanning trees with the same distribution as
those produced by Process~B, and hence also Process~A.

Also, by the memorylessness of exponential random variables, Process~E
is equivalent to selecting an exponential(1) edge weight for each edge
of $G$ and then computing the shortest (or rather, lightest) path
tree rooted at $s$.  We call this latter process \emph{Process~FP}
(for first-passage percolation).  That this process is equivalent to
Process~A can be seen by adding vertices to the shortest path tree rooted
at $s$ in increasing order of the weight of their lightest path to $s$.
At each step in this process, the memoryless property ensures that each
edge adjacent ot exactly one vertex of $T$ is equally likely to be the
next edge added to $T$.

Since these processes produce the same distribution of spanning trees, in
the remainder, $T$ will refer to a spanning tree produced by Process~A,
Process~E, or Process~FP, whichever is convenient.  Since our Process~A
refers to an unweighted graph and Process~FP refers to weighted graph,
we will use the convention that the \emph{length} of a path $P$ is the
number of edges in the path and the \emph{weight}, $W(P)$ of a path
is the sum of the weights on the edges in the path. The \emph{height},
$h(T)$, of $T$ is the length of the longest root-to-leaf path in $T$.

In this paper we show that the expected height of $T$ depends (obviously)
on the diameter, $D$, of $G$ and (less obviously) on the maximum degree,
$\Delta$ of $G$.  We prove the following results:

\begin{itemize}
  \item For any $n$-vertex graph $G$, the expected height of $T$ is
  $O(\Delta(D+\log n))$.  For $D>\log n$, this is tight; for every
  $\Delta\ge 2$ and every $D \ge \log\Delta$, there exists a graph of
  diameter $D$ and maximum degree $\Delta$ such that the expected height
  of $T$ is $\Omega(\Delta D)$.

  \item For any $n$-vertex $d$-degenerate graph $G$,\footnote{The concepts
  of degeneracy, Euler genus, thickness, and treewidth are defined in \secref{degeneracy-discussion}.} the expected height
  of $T$ is $O(\sqrt{d\Delta}(D+\log n))$.  The class of $O(1)$-degenerate
  graphs is enormous and includes every minor-closed graph family.
  This upper bound is tight, even for planar graphs ($d=5$), graphs of
  thickenss $t$ ($d=5t$), and graphs of treewidth $k$ ($d=k$).

  \item For any $n$-vertex graph $G$ of Euler genus $g$, the expected height
    of $T$ is $O(\sqrt{\Delta}(D+g+\log n))$.

  \item On the $d$-dimensional grid of side-length $n$, the expected
    height of of $T$ is $O(D)=O(dn)$. This holds for any $d\ge 1$ and any
    $n\ge 1$. In particular, it implies this result for the hypercube
    ($n=2$ and $d$ variable) and the 2-dimensional grid ($d=2$ and $n$
    variable) and everything in between.
\end{itemize}

\section{Inequalities for Sums of Exponentials}

We will make use of two inequalities on sums of exponential random
variables, both of which can be obtained using Chernoff's bounding
method.  If $Z_1,\ldots,Z_k$ are independent $\exponential(\lambda)$
random variables (so that they each have mean $\mu=1/\lambda$), then
for all $d>1$,

\begin{equation}
    \Pr\left\{\sum_{i=1}^k Z_i \le \mu k/d\right\} \le \exp(-k(\ln d -1 + 1/d)) \le \left(\frac{e}{d}\right)^k  \eqlabel{head-bound}
\end{equation}
and for all $t>1$, 
\begin{equation}
    \Pr\left\{\sum_{i=1}^k Z_i \ge \mu k t\right\} \le \exp (k-kt/2) \enspace . \eqlabel{tail-bound}
\end{equation}


\section{Upper Bounds}

In this section, we prove our upper bounds. All of them are based on
the following lemma about first-passage percolation:

\begin{lem}\lemlabel{percolation}
  If $G$ has diameter $D$ then, with probability at least $1-1/n$,
  the weight of the heaviest root-to-leaf path in the tree $T$ is
  at most $((4\ln n)/D+2)D$.
\end{lem}


\begin{proof}
  Let $v$ be a vertex of $G$ such that there exists a path
  $P=v_0,\ldots,v_k$ with $k$ edges in $G$ from $s=v_0$ to $v=v_k$.
  Let $e_i=v_{i-1}v_i$ be the $i$th edge on this path.

  In Process~FP, each edge $e_i$ is assigned an exponential weight $X_i$.
  The path from $s$ to $v$ in $T$ does not have length greater than
  $W(P)=\sum_{i=1}^k X_i$.
  \begin{align*}
      \Pr\left\{W(P)\ge \left(\frac{4\ln n}{k}+2\right)k\right\} 
        & \le \Pr\left\{Z_1+\cdots Z_k\ge \left(\frac{4\ln n}{k}+2\right)k\right\} \\ 
        & \le \exp\left(k - \left(\frac{4\ln n}{k}+2\right)k/2\right) 
            & \text{(using \eqref{tail-bound})} \\
      & = 1/n^2 \enspace .
  \end{align*}
  For each $v\in V(G)$, let $W(v)$ denote the weight of the path, in
  $T$, from $s$ to $v$, and define $W^*=\max\{W(v):v\in V(G)\}$  as the
  weight of the heaviest root-to-leaf path in $T$.  For each vertex $v$,
  $G$ contains a path from $s$ to $v$ of length at most $D$. Therefore,
  by the discussion above and the union bond,
  \[
      \Pr\{W^*> ((4\ln n/D)+2)D\} \le \sum_{v\in V(G)}\Pr\{t(v) \ge ((4\ln n/D)+2)D\}     
       \le 1/n \enspace . \qedhere
  \]
\end{proof}

\subsection{General Graphs}

We are now ready to prove an upper bound on the height of $T$.

\begin{thm}\thmlabel{alantree-upper-bound}
  If $G$ has diameter $D$ and maximum degree $\Delta$ then, with
  probability at least $1-O(1/n)$, $h(T)\le 2e\Delta D(4\ln n/D)+2)$.
\end{thm}

\begin{proof}
  Let $P=v_0,v_1,\ldots,v_L$ be some simple path in $G$ starting at
  $s=v_0$ and let $e_i=v_{i-1}v_i$ be the $i$th edge on this path.
  In the model of Process~FP, this path has a weight that is the 
  sum of $L$ independent $\exponential(1)$ random variables.
  Using \eqref{head-bound}, we obtain
  \[
      \Pr\{W(P) \le L/d\} \le \left(\frac{e}{d}\right)^L \enspace .
  \]
  If $P$ appears in $T$, then either $W(P) < ((4\ln n/D)+2)D$ or the
  heaviest root-to-leaf path in $T$ has weight greater than $((4\ln
  n/D)+2)D$.  Therefore, by \lemref{percolation} and \eqref{head-bound},
  \[
      \Pr\{\text{$P$ appears in $T$}\} \le 1/n 
        + \left(\frac{e((4\ln n/D)+2)D}{L}\right)^L \enspace .
  \]
  Let $P_L$ be the set of all simple paths in $G$ that start at $s$ and
  have length $L$.  Note that it is sufficient to prove that $T$ contains
  no path from $P_L$ since if it contains a path starting at $S$ and of 
  length greater than $L$, then it also contains a path from $P_L$.  
  The probability that $T$ contains any path from $P_L$
  is at most
  \[
      1/n + |P_L|\left(\frac{e((4\ln n/D)+2)D}{L}\right)^L 
      < 1/n + \left(\frac{\Delta e((4\ln n/D)+2)D}{L}\right)^L \enspace ,
  \]
  Taking $L=2e\Delta D (4\ln n/D)+2)$ and simplifying completes the proof.
\end{proof}

Observe that the factor $\Delta$ in \thmref{alantree-upper-bound} is only
used in the last step of the proof, in order to cancel the $\Delta^L$
that upper bounds $|P_L|$, the number of paths of length $L$ that begin
at $s$.  In the next section we show that, for many classes of graphs the
number of paths that begin at $s$ and have length $L$ is significantly
smaller, and this leads to a reduced dependence on $\Delta$ for graphs
in these classes.

\subsection{Degenerate Graphs}

A graph $G$ is $d$-degenerate if every induced subgraph of $G$ has
a vertex of maximum degree $d$.  The following lemma shows that, for
large $L$, $d$-degenerate graphs have considerably less that $\Delta^L$
walks of length $L$.

\begin{lem}\lemlabel{few-walks}
   Let $G$ be an $n$-vertex $d$-degenerate graph. Then the number of
   walks in $G$ of length $L$ is at most $2n2^{L}(d\Delta)^{L/2}$.
   In particular, if $L > D\log\Delta$, then the number of walks in $G$
   of length $L$ is at most $(cd\Delta)^{L/2}$ for some constant $c$.
\end{lem}

\begin{proof}
   Order the vertices of $G$ $v_1,\ldots,v_n$ so that $v_i$ has at most
   $d$ edges in the subgraph induced by $v_i,\ldots,v_n$ (this ordering
   is obtained by repeatedly removing a degree $d$ vertex).

   Let $W=v_{i_0},\ldots,v_{i_L}$ be any walk of length $L$ in $G$ and
   let and let $k$ denote the number of indices $\ell$ such that $i_{\ell-1}
   < i_{\ell}$.  
   If $k\ge n/2$ then we can specify $W$ in the following way:
   \begin{enumerate}
     \item We first specify the starting vertex $V_{i_1}$.  There $n$
       ways to do this.
     \item Next we specify whether $i_{\ell-1} < i_{\ell}$ for each
       $\ell\in\{1,\ldots,L\}$.  There are $2^L$ ways to do this.
     \item Next, we specify each edge of $W$.  For each
       $\ell\in\{1,\ldots,L-1\}$, if $i_{\ell} < i_{\ell+1}$,
       then there are $d$ ways to do this, otherwise there are $\Delta$
       ways to do this.
      Therefore, the total number of ways to specify this (for all edges
      in $W$) is at most
      \[   d^k\Delta^{L-k} \le (d\Delta)^{L/2}  \enspace ,\]
      since $d\le \Delta$ and $k\ge L/2$.
   \end{enumerate}
   Therefore, the total number of walks of length $L$ for which $k\ge
   L/2$ is at most $n2^L(d\Delta)^{L/2}$ and the total number of walks
   of length $L$ is at most twice this: $2n2^L(d\Delta)^{L/2}$.

   The second part of the theorem comes from the fact that $D\ge \log_\Delta n$, so, when $L>D\log\Delta=\log n$,
   \[ (32d\Delta)^{L/2} \ge 2n2^L \enspace . \qedhere \]
\end{proof}

\begin{thm}\thmlabel{alantree-upper-bound-degenerate}
  If $G$ is $d$-degenerate, has diameter $D$, and has maximum degree
  $\Delta$ then, with probability at least $1-O(1/n)$, $h(T)\in
  O((\sqrt{d\Delta}(D+\ln n))$.
\end{thm}

\begin{proof}
  The proof is identical to the proof of \thmref{alantree-upper-bound}
  except that we choose a value $L \in \Theta(\sqrt{d\Delta}(D+\log n))$ and use
  \lemref{few-walks} to bound the size of the set $P_L$.
\end{proof}


\subsubsection{Remarks}
\seclabel{degeneracy-discussion}

Note that \thmref{alantree-upper-bound-degenerate} actually implies
\thmref{alantree-upper-bound}, since all graphs of maximum degree $\Delta$
are $\Delta$-degenerate so $\sqrt{d\Delta}\le \Delta$ in all cases.
However, \thmref{alantree-upper-bound-degenerate} covers many special
graph classes:

\begin{itemize}
  \item Planar graphs are 5-degenerate. (This is a consequence of Euler's
    formula and the fact that planarity is preserved under taking subgraphs).
  
  \item The \emph{thickness} of a graph is the minimum number of planar
    graphs into which the edges of $G$ can be partitioned. Graphs of
    thickness $t$ are $5t$-denegenerate.  (This follows from definitions
    and the $5$-degeneracy of each individual planar graph in the
    partition.)

  \item The \emph{Euler genus} of a graph is the minimum Euler genus of
    a surface on which the graph can be drawn without crossing edges.  Graphs of
    Euler genus $g$ are $O(\sqrt{g})$-degenerate.

  \item A \emph{tree decomposition} of a graph $G$ is a tree $T'$ whose
  vertex set $B$ is a collection of subsets of $V(G)$ called \emph{bags}
  with the following properties:
  \begin{enumerate}
    \item For each edge $vw$ of $G$, there is at least one bag $b\in B$
      with $\{v,w\}\subseteq B$.
    \item For each a vertex $v$ of $G$, the subgraph of $T'$ induced by
      the set of bags that contain $v$ is connected.
  \end{enumerate}
  The \emph{width} of a tree-decomposition is one less than the size
  of its largest bag.  The treewidth of $G$ is the width of the minimum
  width tree decomposition of $G$.
  Graphs of treewidth $k$ are $k$-degenerate. (This is a consequence
  of the fact that $k$-trees are edge-maximal graphs of treewidth $k$.)
\end{itemize} 

Therefore, \thmref{alantree-upper-bound-degenerate} implies that,
when the relevant parameter, $g$, $t$ or $k$, is constant, $h(T)\in
O(\sqrt{\Delta}(D+\log n))$ with high probability.  


%In the next section,
%we show that these results are asymptotically tight, at least when  $D\in
%\Omega(\log n)$.

\subsection{Graphs of Bounded Genus}

\thmref{alantree-upper-bound} implies that, when $G$ has Euler genus $g$,
the expected height of $T$ is $O(g^{1/4}\Delta^{1/2}(D+\log n)$.  Here we
show that the dependence on the genus $g$ can be reduced further still.

\begin{lem}\lemlabel{few-paths-genus}
   Let $G$ be a simple $n$-vertex graph of Euler genus $g$ and maximum degree
   $\Delta$. Then the number of simple paths in $G$ of length $L$
   is at most $2n2^{L}6^{L/2-3g}\Delta^{L/2+3g}$.
   In particular, if $L>D\log\Delta$, then the number of simple paths in $G$
   is at most $(c\Delta)^{L/2+3g}$ for some constant $c$.
\end{lem}

\begin{proof}
   Since $G$ has Euler genus $g$, it can be 2-cell embedded in a surface
   of Euler genus $g$.  Euler's formula then states that 
   \begin{equation}
      e = n+f-2+g \enspace ,  \eqlabel{euler}
   \end{equation}
   where $n$ and $e$ are the numbers of vertices and edges of
   $G$ and $f$ is the number of faces in the embedding of $G$
   \cite{mohar.thomassen:graphs}.  Since every face of the embedding is
   bounded by at least 3 edges and every edge is on the boundary of at
   most 2 faces, $f \le 2e/3$, so \eqref{euler} becomes
   \[
       e\le 3n-6+3g \enspace .
   \]
   Therefore, the average degree of an $n$-vertex Euler genus $g$ graph
   is at most $6+(6g-12)/n$.  In particular, if $n \ge 6g$, then $g$
   has average degree less than 7, so $G$ contains a vertex of degree
   at most $6$.
   
   Therefore, we can order the vertices of $G$ as $v_1,\ldots,v_n$ so that,
   for each $i\in\{1,\ldots,n-6g\}$, $v_i$ has at most 6 neighbours among
   $v_{i+1},\ldots,v_n$.  We call $v_{n-6g+1},\ldots,v_n$ \emph{core vertices}
   and edges between them are \emph{core edges}.

   Let $P=v_{i_0},\ldots,v_{i_L}$ be any simple path of length $L$ in $G$.
   An edge $v_{i_\ell}v_{i_{\ell+1}}$ in $P$ is \emph{bad} if it is a core
   edge or if $i_{\ell}>i_{\ell+1}$. If an edge of $P$ is not bad, then
   it is \emph{good}.  Let $k$ denote the number of good edges in $P$.

   If $k\ge n/2-3g$ then we can specify $W$ in the following way:
   \begin{enumerate}
     \item We first specify the starting vertex $v_{i_1}$.  There $n$
       ways to do this.
     \item Next we specify whether each edge of $P$ is good or bad.
       There are $2^L$ ways to do this.
     \item Next, we specify each edge of $P$.  For each good edge,
       there are at most 6 ways to do this. For each bad edge there are 
       at most $\Delta$ ways to do this.
      Therefore, the total number of ways to specify the edges of $P$ is at most
      \[   6^k\Delta^{L-k} \le 6^{L/2-3g}\Delta^{L/2+3g}  \enspace ,\]
      since $k\ge L/2-3g$ and $\Delta\ge 6$.
   \end{enumerate}
   Therefore, the total number of simple paths of length $L$ for which
   $k\ge L/2-3g$ is at most $n2^L6^{L/2-3g}\Delta^{L/2+3g}$.  Any simple
   path uses most $6g$ core edges.  Therefore, for any simple path
   $P$ of length $L$, either $P$ or its reverse has $k\ge L/2-3g$.
   Thus, the total number of simple paths of length $L$ is at most
   $2n2^L6^{L/2-3g}\Delta^{L/2+3g}$ as required.
\end{proof}


\begin{thm}\thmlabel{alantree-upper-bound-genus}
  If $G$ has Euler genus $g$, has diameter $D$, and has maximum degree
  $\Delta$ then, for any $\epsilon>0$, with probability at least $1-O(1/n)$, $h(T)\in
  O(\Delta^{1/2+\epsilon}(D+g/\epsilon+\log n))$.
\end{thm}

\begin{proof}
  The proof is identical to the proof of
  \thmref{alantree-upper-bound} except that we choose a value $L
  \in \Theta(\Delta^{1/2+\epsilon}(D+g/\epsilon+\log n))$ and use
  \lemref{few-paths-genus} to bound the size of the set $P_L$.
\end{proof}


\section{Lower Bounds}
\seclabel{lower-bounds}

Note that Theorems~\ref{thm:alantree-upper-bound} and
\ref{thm:alantree-upper-bound-degenerate} are obviously asymptotically
tight for graphs with maximum degree $\Delta\in O(1)$ and diameter
$D\in\Omega(\ln n)$.  For instance, \thmref{alantree-upper-bound}
shows that, for constant $d$, running Process~A on a $n^{1/d}\times
\cdots\times n^{1/d}$ grid or toroidal grid produces a spanning tree of
height $\Theta(n^{1/d})$.  For $d\in O(1)$, this is tight.

However, \thmref{alantree-upper-bound} is not tight for some graphs,
like the $d$-dimensional hypercube, which has $n=2^d$ vertices, maximum
degree $\Delta = d/2 \in \Theta(\log n)$ and diameter $D=d\in\Theta(\log
n)$, thus \thmref{alantree-upper-bound} upper bounds the height
of $T$ by $O(\log^2 n)$.  However, a result of Fill and Pemantle
\cite{fill.pemantle:first} shows that, with high probability, the
heaviest root leaf path in $T$ has weight $O(1)$.  Using this, instead
of \lemref{percolation}, in the proof of \thmref{alantree-upper-bound}
shows that, with high probability the height of $T$ is $O(\log n)$.

It is natural to ask if one can eliminate or reduce the dependence on
$\Delta$ in \thmref{alantree-upper-bound}.  Intuitively, higher degree
should produce spanning trees of lower diameter.  However, the example
of a sequence of $D/2$ $(\Delta-1)$-cliques joined in sequence (see
\figref{clique-path}) shows that Process~A may produce spanning trees
of diameter $\Omega(D\ln\Delta)$.  Therefore the dependence on $\Delta$
can not be eliminated entirely; there is at least a logarithmic dependence
on $\Delta$.

\begin{figure}
  \begin{center}
    \includegraphics{figs/clique-path}
  \end{center}
  \caption{A sequence of $D/2$ $(\Delta-1)$-cliques gives a graph $G$
   with diameter $D$ and maximum degree $\Delta$ for which Process~A
   produces a spannning tree of height $\Omega(D\log\Delta)$.}
  \figlabel{clique-path}
\end{figure}

Next we show that, in fact, a linear dependence on $\Delta$ is necessary:
For any $\Delta$ and any $D\in\Omega(\log\Delta)$, we can construct a
graph $G=G_{D,\Delta}$ of diameter $D$ and maximum degree $\Delta$ for
which Process~A produces a spanning tree of diameter $\Omega(\Delta D)$.
Thus, the upper-bound of \thmref{alantree-upper-bound} is asymptotically
tight for these graphs.

\subsection{Lower Bounds for General Graphs}

The graph $G$ is obtained by gluing together two graphs $H$ and $I$.
The graph $H$ has high diameter and high connectivity.  The graph $I$
has low connectivity and low diameter.  By joining them we obtain a graph
of low diameter (because of $I$) but for which Process~A is more likely
to find paths in $H$ (because of its high connectivity).  We begin by
defining and studying $H$ and $I$ independently.


\subsection{The Ladder Graph $H$}

Fix some integers $L,\delta\in\N$ to be described later and some
constant $a>1$, also described later.  Refer to
\figref{h}.  The vertices of $H$ are partitioned in to $L$ groups
$V_1,\ldots,V_L$, each of size $\delta$. The edge set of $H$ is
\[
   E(H) = \bigcup_{i=1}^{L-1} \{vw : v\in V_{i},\, w\in V_{i+1}\} \enspace .
\]
\begin{figure}
  \begin{center}
    \includegraphics{figs/h} 
  \end{center}
  \caption{The graph $H$.}
  \figlabel{h}
\end{figure}

First we show that $H$, under the models of Process~E and Process~FP
has very low-weight paths between its vertices.
Assign an independent $\exponential(1)$ weight to each edge of $H$.
Let $d_H(v,w)$ denote the weight of the minimum weight path from $v$
to $w$ in the resulting weighted graph.

\begin{lem}\lemlabel{lightning}
   For any vertex $v\in V_i$ and any vertex $w\in V_j$, $j>i$,
   \[
       \Pr\{d_H(v,w) > t(j-i-1)/\delta + r) \} \le
       \begin{cases}
           \exp(-r) & \text{if $j-i=1$} \\
           \exp((1-t/2)(j-i-1)) + \exp(-r) & \text{otherwise.}
       \end{cases}
   \]
\end{lem}

\begin{proof}
   Consider the following greedy algorithm for finding a path from $v$
   to $w$: The path starts at $v$ (which is in $V_i$).  When the path
   has reached some vertex $x\in V_{k}$, for $k<j-1$, the algorithm
   extends the path by taking the minimum-weight edge joining $x$ to some
   vertex in $V_{k+1}$.  When the algorithm reaches some $x\in V_{j-1}$,
   it takes the edge $xw$.

   Let $m=j-i$.  Each of the first $m-1$ edges in the resulting path
   has a weight that is the minimum of $\delta$ $\exponential(1)$
   random variables.  Thus, the weight of these edges is the sum of
   $m-1$ $\exponential(\delta)$ random variables $X_1,\ldots,X_{m-1}$.
   By \eqref{tail-bound},
   \begin{equation}
     \Pr\left\{\sum_{\ell=1}^{m-1} X_\ell > t(m-1)/\delta \right\} \le 
        \exp((1-t/2)(m-1)) \enspace .  \eqlabel{part-i}
   \end{equation}
   The last edge in this path has a weight $X_m$ that is an
   $\exponential(1)$ random variable.  From the definition
   of the exponential distribution,
   \begin{equation}
      \Pr\{X_m > r\} = \exp(-r) \enspace . \eqlabel{part-ii}
   \end{equation}
   We complete the proof with the union bound:
   \begin{align*}
      \Pr\{d_H(v,w) > t(m-1)/\delta + r\} &
        = \Pr\left\{\sum_{\ell=1}^m X_m > t(m-1)/\delta + r\right\} \\
        & \le \Pr\left\{\sum_{\ell=1}^{m-1} X_\ell > t(m-1)/\delta\right\}
          + \Pr\{X_m>r\} \\
        & \le \exp((1-t/2)(m-1)) + \exp(-r) \enspace . \qedhere
   \end{align*}
\end{proof}

Note that the proof of \lemref{lightning} actually studies the length of
the greedy path from $v$ to $w$; call this $d_H^{\mathrm{greedy}}(v,w)$.
For a fixed $k$, $\Pr\{d_H^{\mathrm{greedy}}(v,w) > k\}$ is clearly
maximized for $v\in V_1$ and $w\in V_L$. Therefore, by taking
$r=aL/(e^2\delta)$ and $t=a/e^2$ (so that $tL/\delta+r = 2aL/(e^2\delta)$)
we obtain the following special case of \lemref{lightning}:

\begin{cor}\corlabel{lightning}
  For any $i$ and $j$ and any $v\in V_i$, $w\in V_j$, 
  \[
    \Pr\{d_H(v,w) > 2aL/(e^2\delta)\} 
        \le \exp((1-a/(2e^2))L) + \exp(-aL/(e^2\delta)) \enspace . 
  \]
\end{cor}

\subsection{The Subdivided Tree $I$}

Next, we consider a graph $I$ that is obtained by starting with a complete
binary tree having $L$ leaves and then subdividing each edge incident
to a leaf $\lceil aL/\delta\rceil-1$ times so that each leaf-incident
edge becomes a path of length $\lceil aL/\delta\rceil$.  Note that $I$
has height $\lceil aL/\delta\rceil+\lceil\log_2 L\rceil$.

Assign independent $\exponential(1)$ edge weights to each edge of $I$
and, for two leaves $v$ and $w$, let $d_I(v,w)$ denote the weight of
the unique path from $v$ to $w$.

\begin{lem}\lemlabel{slow-train}
   $\Pr\{d_I(v,w) \le 2aL/(e^2\delta)\} \le \exp(-2aL/\delta)$
\end{lem}

\begin{proof}
  The path from $v$ to $w$ in $I$ contains at least $2\lceil
  aL/\delta\rceil$ edges.  Therefore, the weight of this path is
  lower-bounded by the sum of $2\lceil aL/\delta\rceil$ independent
  $\exponential(1)$ random variables.  The lemma then follows by applying
  \eqref{head-bound} to this sum.
\end{proof}


\subsection{Putting it Together}

The lower-bound graph $G$ is now constructed by taking a tree $I$ with
$L$ leaves and a graph $H$ with $L$ groups $V_1,\ldots,V_L$ each of size
$\delta=\lfloor(\Delta-1)/2\rfloor$.  Next, we consider the leaves of
$I$ in the order they are encountered in a depth first-traversal of $I$
and, for each $i\in\{1,\ldots,L\}$ we identify the $i$th leaf of $I$
with some vertex in $V_i$.  See \figref{g}.

\begin{figure}
  \begin{center}
    \includegraphics{figs/g}
  \end{center}
  \caption{The lower bound graph $G$. Dotted segments denote subdivided edges (path of length $\lceil aL/\delta\rceil$).}
  \figlabel{g}
\end{figure}

Note that the graph $G$ has maximum degree $\Delta\le 2\delta+1$.
Furthermore, every vertex of $G$ is either in $I$, or adjacent to a
vertex in $I$.  Therefore, $G$ has diameter
\[
    D = 2+2(\ln L + aL/\delta) = O(L/\Delta) \enspace ,
\]
for $L\in\Omega(\Delta\ln\Delta)$.

Note that the graph $G$ has three parameters $a$, $L$, and $\Delta$,
so we will call this graph $G(a,L,\Delta)$.
%\[
%   D\in O((\ln\delta + \ln\ln L)\ln L + L/\delta) = O(L/\Delta)
%\]
%for $L\in\Omega(\Delta\ln\Delta\ln\ln\Delta)$.  That is, for any
%$\Delta$ and any $D\in\Omega(\ln\Delta\ln\ln\Delta)$ we can construct
%a graph $G$ with diameter $D$ and maximum degree $\Delta$.
%
\begin{thm}\thmlabel{alantree-lower-bound}
  For every $\Delta\ge 3$ and every $L\in\Omega(\Delta\ln\Delta)$, there
  exists a constant $a$ such that If we run Process~A on $G(a,L,\delta)$
  starting at some vertex $s\in V_1$, then with probability at least
  $1-o_L(1)$, the resulting spanning tree contains a path of length at
  least $L-1$.
\end{thm}

\begin{proof}
  In the Process~FP view, we assign each edge of $G$ an $\exponential(1)$
  edge weight and compute a shortest path tree $T$ rooted at $s$ in
  the resulting weighted graph.  Consider the path $P$ in $T$ from $s$
  to an arbitrary vertex $t$ in $V_L$.  If $P$ uses no edges of $T$,
  then it has at least $L-1$ edges.  If $P$ does use some edge of $T$,
  then this implies that there are two leaves $v$ and $w$ of $I$ such
  that $d_H(v,w) \ge d_I(v,w)$.

  Using \corref{lightning} and \lemref{slow-train}, we have
  \begin{align*}
     \Pr\{d_H(v,w) \ge d_I(v,w)\}
       & \le \binom{L}{2}\left(\Pr\{d_H(v,w) > 2aL/\delta\} + \Pr\{d_I(v,w) < 2aL/\delta\}\right)  \\
       & \le \binom{L}{2}\left(\exp((1-a/2e^2)L) 
                + \exp(-aL/(e^2\delta)) 
                + \exp(-2aL/\delta)
              \right)
  \end{align*}
  For large $L$, this probability tends to zero when $a\ge \max\{4e^2, 3e^2\delta\ln L/L\}$.  Such a constant $a$ exists for any $L\in\Omega(\Delta\log\Delta)$.
\end{proof}

\subsection{Lower Bounds for Degenerate Graphs}

Next we show that the construction given above can be adapted to graphs
of low degeneracy.

\begin{thm}\thmlabel{alantree-lower-bound-planar}
  For every $\Delta\ge 3$ and every $L\in\Omega(\sqrt{\Delta}\ln\Delta)$,
  there exists a planar graph $G$ with maximum degree $\Delta$, diameter
  $O(L/\sqrt{\Delta})$ and having a vertex $s$ such that, if we run
  Process~A on $G$ starting at $s$, then with probability at least
  $1-o_L(1)$, the resulting spanning tree contains a path of length at
  least $2L-1$.
\end{thm}

\begin{proof}
  The graph $G$ is very similar to $G(a, L,\delta)$ except that the ladder
  graph $H$ is replaced with the planar graph shown in \figref{planar-h}.
  The tree, $I$ attached to $H$ is the same as before, but it's bottom
  edges are only subdivided $aL/\sqrt{\delta}$ times.  The resulting
  graph is planar, has diameter $D\in\Theta(L/\sqrt{\delta})$ and maximum
  degree $\Delta\in O(\delta)$.

  \begin{figure}
    \begin{center}
      \includegraphics{figs/planar-h}
    \end{center}
    \caption{The graph $H$ in the proof of \thmref{alantree-lower-bound-planar}.}
    \figlabel{planar-h}
  \end{figure}
 
  In this graph, one can go from any vertex in $V_i$ to some vertex in 
  $V_{i+1}$ by taking a path
  whose weight is the minimum of $\delta$ $\gammarv(2,1)$ random
  variables.  The expected length of this path is therefore at most
  $\ell=c(L-1)/\sqrt{\delta}$ for some constant $c$. Therefore, there is
  a path from any vertex in $V_1$ to some vertex in $V_L$ whose weight is
  the sum of independent random variables $X_1,\ldots,X_{L-1}$, where each
  $X_i$ is distributed like the minimum of $\delta$ $\gammarv(2,1)$ random
  variables. Any standard trick for concentrating sums of independent
  random variables then shows that the probability that the weight of
  this path exceeds $2\ell$ is $o_L(1)$.

  As in the proof of \thmref{alantree-lower-bound}, this implies
  that the only way in which a path of length at least $2L-1$ does not
  appear in $T$ is if $I$ contains a path from one leaf to another whose
  weight is less than $2\ell$.  As in the proof of \lemref{slow-train},
  \eqref{tail-bound} shows that, when $a$ is chosen sufficiently large,
  the probability this is occurs is $o_L(1)$.
\end{proof}


\begin{thm}\thmlabel{alantree-lower-bound-degenerate}
  For every $\Delta\ge 3$, $d\le \Delta$ and every
  $L\in\Omega(\sqrt{d\Delta}\ln\Delta)$, there exists a $d$-degenerate
  graph $G$ with maximum degree $\Delta$, diameter $O(L/\sqrt{d\Delta})$
  and having a vertex $s$ such that, if we run Process~A on $G$ starting
  at $s$, then with probability at least $1-o_L(1)$, the resulting
  spanning tree contains a path of length at least $2L-1$. Furthermore,
  the graph $G$ has thickness at most $d$ and treewidth at most $3d+1$.
\end{thm}

\begin{proof}
  Again, the graph $G$ is very similar to $G(a, L,\delta)$ except that
  the ladder graph $H$ is replaced with a sequence of $2L-1$ groups
  of vertices, $V_{1},V_{1}',V_2,V_2',\ldots,V_{L-1},V_{L-1}',V_L$.
  See \figref{degenerate-h}.  Each consecutive pair in this sequence
  forms a complete bipartite graph.  Each $V_i$ has $\delta$ vertices
  and each $V_i'$ has $d$ vertices.  The tree portion, $I$, of $G$ is
  as before except that the edges incident to leaves are now subdivided
  $aL/\sqrt{d\delta}$ times.  The resulting graph, $G$, has diameter
  $D=O(L/\sqrt{d\delta})$, and maximum degree $\Delta = 2\delta+1$.

  \begin{figure}
    \begin{center}
       \includegraphics{figs/degenerate-h}
    \end{center}
    \caption{The $d$-degenerate graph $H$ used in the proof of
       \thmref{alantree-lower-bound-degenerate}. In this example, $\delta=7$
        and $d=3$.}
    \figlabel{degenerate-h}
  \end{figure}

  The graph $G$ is $d$-degenerate because the vertices of degree greater
  than $d$ form an independent set. Therefore, every induced subgraph
  of $G$ is either an independent set (so has a vertex of degree 0)
  or contains a vertex of degree at most $d$.

  To see that $G$ has thickness $d$, assign each vertex of each
  $V_{i'}$ to one of $d$ color classes, so that each $v\in V_i'$ is
  assigned a distinct colour.   Now partition the edges incident to
  these vertices amond $d$ subgraphs depending on the color of the
  vertex they are assigned to.  Edges not incident to these vertices
  can be assigned to any subgraph.  With this partition of edges, each
  subgraph becomes a subgraph of the planar graph used in the proof of
  \thmref{alantree-lower-bound-planar}.

  To see that $G$ has treewidth $3d+1$, we show a tree decomposition
  of $G$ with bags of maximum size $3d+2$.  For convenience, we will
  define $V_0=V_{L+1}=\emptyset$.

  We begin with a tree $T'$ of bags that has the same shape as $I$ and,
  for each vertex $v$ of $I$, let $B_v$ denote the bag corresponding
  to $v$.
  \begin{enumerate}
    \item Assign each vertex of $v$ of $I$ to $B_v$ and the (up to 2)
      children of $B_v$ in $T'$.

    \item Let $v_1,\ldots,v_L$ be the
     leaves of $I$ ordered so that each $v_i\in V_i$. In the leaf bag
     $B_{v_i}$ of $T'$ we add all vertices in
     $V_{i-1}'$ and $V_{i'}$.

     Now each vertex in $V_{i'}$ appears in $B_{v_i}$ and $B_{v_{i+1}}$
     so we add all the elements of $V_i'$ to each of the $B_v$ the path
     from $v_i$ to $v_{i+1}$ in $I$.

    \item  Finally, to each $B_{v_i}$ we attach $\delta-1$ bags as leaves
     of $T'$ and in each bag we place all the vertices in $V_i'$,
     $V_{i+1}'$, and a distinct vertex of $V_i\setminus\{v_i\}$. We
     call each such bag $B_v$, where $v$ is the unique vertex of
     $V_i\setminus\{v_i\}$ contained in the bag.
  \end{enumerate}

  No bag contains more than $3d+2$ vertices: For each vertex $v$ of
  $I$, $B_v$ contains at most two vertices from $I$ ($v$ and $v$'s
  parent) and possibly all of $V_{i-1}'$, $V_i'$ and $V_{i+1}'$ for
  some $i\in\{1,\ldots,L\}$).  For each $v\in V_i\setminus\{v_i\}$,
  $B_v$ contains at most $2d+1$ vertices; $v$ and the vertices in
  $V_{i-1}'\cup V_{i}'$.

  For each edge $vw$ of $G$, there is some bag that contains both $v$
  and $w$: If $vw$ is an edge of $T$ with $v$ a child of $w$ then $B_v$
  contains both $v$ and $w$. Otherwise, $v\in V_i$ and $w\in V_{i-1}'$
  or $w\in V_{i}'$, in which case $v$ and $w$ appear in $B_v$.

  Finally, for each vertex $v$ of $G$, the subgraph of $T'$ induced by
  bags containing $v$ is connected: For a vertex $v\in I$ this subgraph
  is either an edge or a single vertex.  For a vertex $v\in V_i$ this
  subgraph is a single vertex.  For a vertex $v\in V_{i'}$ this subgraph
  is a path joining two vertices of $T'$.

  Therefore, $T'$ is a tree-decomposition of $G$ with whose largest bag
  has size $3d+2$.  Therefore $G$ has treewidth at most $3d+1$.

  As before, all that remains is to show that with probability
  $1-o_L(1)$, there is a path from $s\in V_1$ to some vertex $v\in
  V_{L}$ whose weight is at most $cL/\sqrt{d\delta}$.  Again, we
  find this path with a greedy algorithm.  To move from some vertex
  $v\in V_i$ to $V_{i+1}$, we consider $d\delta$ paths from $v$ to a
  vertex in $V_i'$ to a vertex in $V_{i+1}$ and take the lightest one.
  The weight of the second edge of each such path is the minimum of
  $\delta$ independent $\exponential(1)$ random variables, so it is an
  $\exponential(\delta)$ random variable.  The first edge of each such
  path is an $\exponential(1)$ random variable.  Thus, the weight of the
  path we choose is distributed like $\min\{Z_i:i\in\{1,\ldots,d\}\}$,
  where $Z_i,\ldots,Z_d$ are independent and $Z_i=X_i+Y_i$ with $X_i\sim
  \exponential(1)$ and $Y_i\sim\exponential(\delta)$.
\end{proof}

 

\section{Some Fluff}

This is just a place to try out a few arguments.  First, let's look at high dimensional grids:

\subsection{Grids in Higher Dimensions}
\label{sec:grids_old}

The $d$-dimensional $(n+1)\times\cdots (n+1)$ grid is the is the graph
whose vertex set is $\{0,\ldots,n\}^d$ and in which two vertices are
adjacent if their Euclidean distance is exactly 1.

The grid has diameter $D=dn$ and maximum degree $\Delta=2d$.  For
$d=O(1)$, \thmref{alantree-upper-bound} gives an asymptotically tight bound of
$O(n)$ on the height of the spanning tree, but for non-constant $d$,
gives an upper bound of $O(d^2n) = O(dD)$, which is not obviously tight.
Here, we argue that, at least for a very large range of $d$, the height
of the spanning tree is only $O(dn)=O(D)$.

\begin{lem}\lemlabel{grid}
  If $G$ is a $d$-dimensional $(n+1)\times\cdots\times(n+1)$  grid with
  $d\in o(n/\log n)$ then, with probability at least $1-O(n^{-ad})$, the
  lightest path from $(n,\ldots,n)$ to $(0,\ldots,0)$ has weight $O(n)$.
\end{lem}

\begin{proof}
Consider the \emph{greedy path} that repeatedly chooses the minimum weight edge
that reduces a vertex coordinate.  This greedy path will reach $(0,\ldots,0)$ after exactly $dn$ steps.  Let  
\[
    r=dn-\sqrt{ad^3n\ln n}
\]
Let $\mathcal{E}_r$ denote the event that any coordinate becomes $0$
during the first $r$ steps.
We claim that
\[
    \Pr\{\mathcal{E}_r\} \le \exp(-\Omega(ad\log n)) \enspace .
\]
Indeed, until some coordinate reaches zero, each of the $d$ coordinates
is equally likely to be reduced.  Therefore, after $r$ steps, the
number of times the $i$th coordinate has been reduced is dominated by
a $\binomial(r, 1/d)$ random variable, $B_i$, that has mean 
\[
    \mu=r/d = n - \sqrt{adn\ln n} \enspace .
\]
Therefore, 
\begin{align*}
    \Pr\{B_i \ge n\} 
       & = \Pr\{B_i \ge (n/\mu)\mu\} \\
       & = \Pr\left\{B_i \ge 
           \left(1+\Theta\left(\sqrt{\frac{ad\log n}{n}}\right)\mu\right)\right\} \\
       & \le \exp(-\Theta(ad\log n)) \\
       & = n^{-\Theta(ad)} 
\end{align*}
where the last inequality is an application of the simplified Chernoff bound
$\Pr\{X>(1+\epsilon)\mu\} \le \exp(-\epsilon^2\mu/3)$. 

Let $\mathcal{E}$ be the event: $\max\{B_i:i\in\{1,\ldots,d\}\} \ge n$.  Then the union bound gives:
\[
    \Pr\{\mathcal{E}_r\}
    = \Pr\{\max\{B_i:i\in\{1,\ldots,d\}\} \ge n\} 
    \le d n^{-\Theta(ad)} = n^{-\Theta(ad)} \enspace .
\]
Let $X_i$ be the weight of the $i$th edge in the resulting path.
Then, conditional on $\overline{\mathcal{E}}_r$, $X_1,\ldots,X_r$ are
independent $\exponential(d)$ random variables. By \eqref{tail-bound},
\[
   \Pr\left\{\sum_{i=1}^r X_i > tn\,\Bigg{|}\, \overline{\mathcal{E}}_r\right\}  
        \le \exp((1-t/2)n) \enspace .
\]
On the other hand, for $i>r$, $X_i$ is dominated by an $\exponential(1)$
random variable, so
\[
   \Pr\left\{\sum_{i=r+1}^{dn} X_i > n \right\}  
      \le \exp\left(-\Theta(n)\right) \enspace .
\]
Therefore the probability that the greedy path (and hence the lightest path) has weight more than $2tn$ is at most 
\[
    \Pr\{\mathcal{E}_r\} + \exp((1-t/2)n) + \exp(-\Theta(n)) = n^{-\Omega(ad)} \enspace ,
\]
for $d\in o(n/\log n)$ and $t\ge 3$. 
\end{proof}

For the general case, in which we want to bound the lightest path from
$(0,\ldots,0)$ to $(x_1,\ldots,x_d)$, we can appeal to the view in which
each edge has an exponential timer that keeps resetting itself when it
rings and we pretend we're in an infinite grid, but we ignore any ring
that would take us outside of $[0,x_1]\times\cdots\times[0,x_d]$. We run
this process until we hear $nd-r$ rings, at which point have crossed
edges for every coordinate at least $nd-o(n/d)$ times, so we're within
distance distance $o(n)$ from the destination vertex.  

\subsection{Slightly simplified argument for grids in higher dimensions}
\newcommand{\prob}[1]
{\Pr\left\{ #1\right\}}

In this section we provide a slightly simpler proof for grids in higher dimensions (so we re-prove everything in Section~\ref{sec:grids_old}).

We consider the $d$-dimensional grid with vertex set
$\{0,1,\dots,n-1\}^d$, which has $n^d$ vertices.
Define $\lambda = 2 + 3 d \ln n / n$.
The main lemma is:
\begin{lem}\label{lem:gridcovertime}
With probability at least $1-1/n$,
Process FP is completed by time $\lambda n$.
\end{lem}

An immediate corollary is that the height of our randomly grown spanning tree is bounded by maximum degree times $\lambda n$, which is $O(dn + d^2 \ln n)$.
Since $dn$ is an obvious lower bound, this is tight whenever $d = O( n/\ln n)$.

\begin{proof}[Proof of Lemma~\ref{lem:gridcovertime}]
Suppose we orient each edge decreasingly:
if $uv$ is an edge, and $v$ is closer to origin than $u$,
then we orient the edge from $u$ to $v$.
For any given vertex $v$, we prove that with probability at least $1-n^{-d-1}$, there is a directed path of weight $\lambda n$ to the origin. Union bound over all vertices completes the proof.

We consider the greedy algorithm for building this path: start from $v$; in each step, among all out-going edges, choose an edge with minimum weight and move along that.
Note that, if the current vertex has $k$ positive coordinates, then the out-degree is $k$, and the expected weight of next edge is $1/k$,
and this edge is equally likely to be any of the $k$ outgoing edges.

We now take an alternative viewpoint:
suppose there are $d$ independent exponential clocks with rate 1, one for each coordinate.
We build the greedy path as follows:
we start from $v$;
whenever the $i$-th clock rings, if the $i$-th coordinate is positive, decrease this coordinate by 1, and reset the clock.
Note that the time it takes to reach the origin, is precisely the weight of the greedy path.
This is easy to see, e.g.\ by induction:
suppose we are at a vertex with $k$ positive coordinates.
Then, we may just focus on the corresponding $k$ clocks.
The expected time to hear a ring is $1/k$, and this ring is equally likely to come from any of the $k$ clocks.
Whenever we make a step, by memoryless property of exponential distribution, we can think that all clocks are reset.

In this clock-based viewpoint, as soon as all clocks have rung at least $n$ times, we have arrived at the origin.
Consider the first clock.
The time it takes for this clock to ring $n$ times is
$X_1+\dots+X_n$,
where $X_i$ are i.i.d.\ exponentials with rate 1.
So, applying union bound over all clocks, it suffices to have
$$d \prob{X_1+\dots+X_n > \lambda n} < n^{-d-1}.$$
This holds for our choice of $\lambda=2+3d \ln n/n$ (e.g.\ it follows from \eqref{tail-bound}).
\end{proof}

\subsection{The Hypercube}

Recall that the $d$-dimensional hypercube is the graph on vertex set
$\{0,1\}^d$ and in which two vertices are adjacent if their Hamming
distance is 1.

Fill and Pemantle show that on the hypercube, first-passage percolation is complete in $O(1)$ time.  Here we do the same with a somewhat different argument.

\begin{lem}\lemlabel{hypercube}
Let $G$ be the $d$-dimensional hypercube with indepedenent $\exponential(1)$ edge weights.  Then the lightest path from $s=(0,\ldots,0)$ to $t=(1,\ldots,1)$ has expected weight $O(1)$.
\end{lem}

\begin{proof}
Fix some constant $0<\alpha<1$ that will be discussed later.
We construct a path from $s$ to $t$ as follows:  The first
$q=\alpha d$ steps of this path make a greedy choice, taking the
lightest edge that reduces the distance to $t$.  During the $i$th step,
$i\in\{0,\ldots,q-1\}$, the weight of the edge crossed is the minimum of
$d-i$ $\exponential(1)$ random variables, so it is an $\exponential(d-i)$
random variable $X_i$. The expected cost of this part of the path is
\[
   \E\left[\sum_{i=0}^{q-1} X_i\right] = 
   \sum_{i=0}^{q-1} E[X_i] = 
   \sum_{i=0}^{q-1} 1/(d-i) = H_d-H_q \le \int_q^d x^{-1}\,\mathrm{d}x = \ln(1/\alpha)  \enspace .
\]

The second part of the path is constructed in a sequence of rounds,
each consisting of three steps---one step back and two steps forward.
For each $\ell\in\{0,\ldots,d\}$, let $L_\ell$ be the set of vertices
having distance $\ell$ from $t$ (so $|L_\ell|={d\choose \ell}$).  Suppose
that, at the start of a round, the algorithm is at vertex $v\in L_k$.
Consider the set, $P$, of all paths $v,x,y,z$ with $x\in L_{k+1}$, $y\in
L_{k}\setminus\{v\}$, and $z\in\{L_{k-1}\}$. The number of paths in
$P$ is $r=(d-k)k^2$; the paths in $P$ are edge-disjoint; and the weight
of each path in $P$ is the sum of three independent $\exponential(1)$
random variables, i.e., it is a $\gammarv(3,1)$ random variable.

This means that the lightest path in $P$ has a weight, $Z_k$, that is
the minimum of $r$ independent $\gammarv(3,1)$ random variables.  We know
that $\E[Z_k]=Cr^{-1/3}$, where $C = C_r = 6^{1/3}\Gamma(1/3)/3 + o_r(1)$.%
\footnote{If $M$ is the minimum of $r$ independent $\gammarv(3,1)$ random
variables, then $Mr^{1/3}$ tends in distribution to a random variable
$Z$: $\Pr\{Z>z\} = \exp(-z^3/6)$, and $\E[Z]= \int_0^\infty \exp(-z^3/6)\,
\mathrm{d}z = C$.}
Therefore,
\[
    \E[Z_k] = Cr^{-1/3} = C((d-k)k^2)^{-1/3} \le C(\alpha dk^2)^{-1/3} \enspace .
\]
The expected weight of the second part of the path is therefore
\begin{align*}
 \E\left[\sum_{k=1}^{d-q} Z_k\right] 
    & = \sum_{k=1}^{d-q} \E[Z_k] \\
    & \le C(\alpha d)^{-1/3}\sum_{k=1}^{(1-\alpha)d} k^{-2/3} \\
    & \le C(\alpha d)^{-1/3}\left(1+\int_1^{(1-\alpha)d} x^{-2/3}\,\mathrm{d}x\right) \\
    & \le 3C(\alpha d)^{-1/3}((1-\alpha)d)^{1/3} \\
    & = 3C(\alpha /(1-\alpha))^{1/3} \enspace .
\end{align*}
Thus, the total expected length of the resulting path is
\[
    \ln(1/\alpha) + 3C(\alpha /(1-\alpha))^{1/3} \enspace . \qedhere
\]
\end{proof}

Minimizing the final expression in the proof of \lemref{hypercube}
gives an upper bound of approximately $4.8$ on the expected weight of
the resulting path.  This is better than Fill and Pemantle's $2(\ln
4+2\sqrt{3})+3\approx 7.02$, but does not come close to Martinsson's
tight bound of $\ln(1+\sqrt{2})\approx 0.881$.

To prove an upper bound on the weight of the heaviest root to leaf path,
we first need a concentration result on the weight, $W$, of the path from
$(0,\ldots,0)$ to $(1,\ldots,1)$ of the form $\Pr\{W > C\} = o(2^{-d})$.
We can do this by showing that the quantities $\sum_{i=1}^q X_i$ and
$\sum_{k=1}^{d-q} Z_k$ are concentrated around their expected values.
The first sum is easy---all the terms are independent, so we can apply
our favourite concentration inequality.  The second sum requires a
little more care, since the $Z_k$'s are not independent. However, $Z_i$
is independent of $Z_j$ if $|j-i| > 1$. Thus, we can apply concentration
inequalities separately to $\sum_{i=1}^{\lfloor q/2\rfloor} Z_{2i}$
and $\sum_{i=1}^{\lceil q/2\rceil} Z_{2i-1}$.

To see what the $(0,\ldots,0)$ to $(1,\ldots,1)$ case is
sufficient, consider the following algorithm for finding a path from
$s=(0,\ldots,0)$ to $v=(b_1,\ldots,b_d)$.  The algorithm starts with a
set $L=\{1,\ldots,d\}$ and performs $\alpha d$ greedy steps.  When the
algorithm is at a vertex $u=(u_1,\ldots,u_d)$, it chooses the lightest
edge that leaves $u$ across a coordinate $i\in L$.  If this edge

XXXXX finish here

\subsection{The Whole Enchilada}

Next we present a theorem that covers the case of the $d$-dimensional
grid with $n^d$ vertices for any $n$ and any $d$.  As a special case,
we obtain the hypercube when $n=2$ and $d\to\infty$.   The argument is a generalization of the argument for the hypercube sketched above.

\begin{lem}
   Let $G$ be the $d$-dimensional grid on vertex set $\{0,\ldots,n\}^d$
   with independent $\exponential(1)$ edge weights. Then, with
   probability $1-o(n^{-d})$, $G$ contains a path from $s=(0,\ldots,0)$
   to $t=(n-1,\ldots,n-1)$ of weight $O(n)$.
\end{lem}

\begin{proof}
   For two vertices
   $v$ and $w$, let $\|vw\|_H$ denote the Hamming distance between $v$ and $w$,
   i.e., the number of coordinates at which $v$ and $w$ differ.
   Let $\|vw\|_1$ denote the $L_1$ distance between $v$ and $w$, i.e., $\|vw\|_1=\sum_{i=1}^d |v_i-w_i|$.  Observe
   that 
   \begin{equation}
      \|vw\|_H \ge \|vw\|_1/n \enspace . \eqlabel{hamming-l1}
   \end{equation}

   We construct the path starting at $s$.  When the path has reached a
   vertex $v$, it is extended in one of two ways:
   \begin{enumerate}
      \item If $\|vt\|_H > \alpha d$, then the path proceeds along the
      lightest edge incident to $v$ that leads to a vertex that is closer
      to $t$.  

      \item Otherwise, the path will cross three edges, one that moves
      further from $t$ and two that move closer to $t$.  For each
      $\ell\in\{0,\ldots,nd\}$, let $L_\ell$ be the set of vertices
      having distance $\ell$ from $t$.
      Consider the set, $P$, of all paths $v,x,y,z$ with
      $x\in L_{k+1}$, $y\in L_{k}\setminus\{v\}$, and $z\in\{L_{k-1}\}$.
      The path then proceeds along the lightest path in $P$.
   \end{enumerate}
   Since both types of extensions reduce the distance to $t$ by one,
   this algorithm reaches $t$ after exactly $nd$ iterations.

   In the first case, this algorithm takes a step across an edge whose
   weight is the minimum of at least $\alpha d$ $\exponential(1)$
   random variables, so the weight of each such step is dominated by an
   $\exponential(\alpha d)$ random variable.

   In the second case, this algorithm considers a whole set $P$
   of edge-disjoint paths.  The weight of each path in $P$ is
   the sum of three $\exponential(1)$ random variables, so it is a
   $\gammarv(3,1)$ random variable.  Since the paths are edge disjoint,
   these $\gammarv(3,1)$ variables are independent, so the weight of
   this path is the minimum of $|P|$ independent $\gammarv(3,1)$ random
   variables and has expected value $C|P|^{-1/3}$, where $C = C_{|P|} =
   6^{1/3}\Gamma(1/3)/3 + o_{|P|}(1)$.%
   \footnote{If $M$ is the minimum of $r$ independent $\gammarv(3,1)$
   random variables, then $Mr^{1/3}$ tends in distribution to a random
   variable $Z$: $\Pr\{Z>z\} = \exp(-z^3/6)$, and $\E[Z]= \int_0^\infty
   \exp(-z^3/6)\, \mathrm{d}z = C$.}
   To prove our result,
   we now need a lower-bound on $|P|$.

   To make a path in $P$ we have $d-\|vt\|_H> (1-\alpha)d$ choices for
   the first edge, $\|v,t\|_H$ choices for the second edge and at least
   $\|vt\|_H$ choices for the third edge. So
   \[
     |P| \ge (1-\alpha)d\|vt\|_H^2 
         \ge (1-\alpha)d(\|vt\|_1/n)^2 
     \enspace ,
   \]
   where the second inequality is an application of \eqref{hamming-l1}.

   We can now pull everything together. The algorithm proceeds in $nd$
   rounds, numbered $0,\ldots,nd-1$.  During the $i$th round, the weight
   of edges crossed is either dominated by an $\exponential(\alpha d)$
   random variable, $X_i$, or by a random variable $Z_i$ that is the
   minimum of $(1-\alpha)d((nd-i)/n)^2$ independent $\gammarv(3,1)$
   random variables.  That is, the total weight of the resulting path
   is dominated by 
   \[
      \sum_{i=0}^{nd-1} (X_i + Z_i)
   \]
   The sum of $X_i$'s has expected value $n/\alpha$ and the sum of the $Z_i$'s
   has expected value:
   \begin{align*}
       \sum_{i=0}^{nd-1} \E[Z_i] 
       & = \sum_{i=0}^{nd-1} C((1-\alpha)d(nd-i)/n^2)^{-1/3} \\
       & = C\left(\frac{(1-\alpha)d}{n^2}\right)^{-1/3}\sum_{i=0}^{nd-1} (nd-i)^{-2/3} \\
       & = C\left(\frac{(1-\alpha)d}{n^2}\right)^{-1/3}\sum_{i=1}^{nd} i^{-2/3} \\
       & = C\left(\frac{(1-\alpha)d}{n^2}\right)^{-1/3}(nd)^{1/3} \\
       & = Cn(1-\alpha)^{-1/3} \enspace .
   \end{align*}
   And we get the concentration result using \eqref{tail-bound} and
   G\'abor's concentration result for the sum of $Z_i$'s.
\end{proof}









\end{document}
